<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">


    <Style x:Key="NavigationTabControlStyle" TargetType="TabControl">
        <Setter Property="TabStripPlacement" Value="Left"/>
        <Setter Property="Margin" Value="0,20,0,0"/>
        <Setter Property="VerticalAlignment" Value="Center"/>
        
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type TabControl}">
                    <Grid Background="Transparent">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="120" />
                            <ColumnDefinition Width="0"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel IsItemsHost="True"
                                    Grid.Column="0"
                                    Background="Transparent"
                                    Margin="0,0,0,0"
                                    SnapsToDevicePixels="True">
                        </StackPanel>

                        <ContentPresenter
                            Grid.Column="1"
                            Margin="0,0,0,0"
                            Content="{TemplateBinding SelectedContent}"/>
                    </Grid>

                    <ControlTemplate.Resources>
                        <Style TargetType="{x:Type TabItem}">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="{x:Type TabItem}">
                                        <Grid Background="Transparent">
                                            <Border Name="Border"
                                                    VerticalAlignment="Center"
                                                    Margin="0,0,0,0"
                                                    Opacity="1"
                                                    Background="Transparent"
                                                    Height="40"
                                                    SnapsToDevicePixels="True">
                                                <Path Name="BPath"  
                                                      Data="M214,108 L346,108 346.125,118.125 337.75,126.125
                                                                 346.375,134 346.375,143.875 214.25,144.25 z"
                                                      SnapsToDevicePixels="True"
                                                      Stretch="Fill"
                                                      Height="40">
                                                    <Path.Fill>
                                                        <SolidColorBrush  Color="Transparent"/>
                                                    </Path.Fill>
                                                </Path>

                                            </Border>


                                            <ContentPresenter x:Name="ContentSite"  
                                              Height="60"
                                              VerticalAlignment="Stretch"   HorizontalAlignment="Stretch" 
                                              RecognizesAccessKey="True">
                                                <ContentPresenter.Content>
                                                    <TextBlock Text="{TemplateBinding Header}"
                                                        VerticalAlignment="Center" HorizontalAlignment="Left" Margin="20,0,0,0"
                                                        FontFamily="Calibri"
                                                        FontSize="14"
                                                        Foreground="AliceBlue"/>
                                                </ContentPresenter.Content>
                                            </ContentPresenter>
                                        </Grid>
                                        <ControlTemplate.Triggers>
                                          

                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="Border" Property="Background">
                                                    <Setter.Value>
                                                        <SolidColorBrush Color="White"/>
                                                    </Setter.Value>
                                                </Setter>


                                                <!--右移一个单位以盖住缺口处的线段-->
                                                <Setter TargetName="Border" Property="Margin" Value=" 0,0,-0.5,0"/>

                                                <Setter TargetName="BPath" Property="Fill" >
                                                    <Setter.Value>
                                                        <SolidColorBrush Color="#74A474"/>
                                                    </Setter.Value>
                                                </Setter>
                                            </Trigger>

                                            <Trigger Property="IsSelected" Value="True">
                                                <Setter Property="Panel.ZIndex" Value="100" />
                                                <Setter TargetName="Border" Property="Background">
                                                    <Setter.Value>
                                                        <SolidColorBrush Color="White"/>
                                                    </Setter.Value>
                                                </Setter>

                                                <!--右移一个单位以盖住缺口处的线段-->
                                                <Setter TargetName="Border" Property="Margin" Value=" 0,0,-1,0"/>

                                                <Setter TargetName="BPath" Property="Fill" >
                                                    <Setter.Value>
                                                        <SolidColorBrush Color="#28813D"/>
                                                    </Setter.Value>
                                                </Setter>
                                            </Trigger>

                                            <Trigger Property="IsEnabled" Value="False">
                                                <Setter TargetName="Border" Property="Background" Value="Silver"/>
                                                <Setter TargetName="Border" Property="BorderBrush" Value="Black" />
                                                <Setter Property="Foreground" Value="DarkGray" />
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </ControlTemplate.Resources>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</ResourceDictionary>